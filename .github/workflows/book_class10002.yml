name: AimHarder Bot WZ

on:
  schedule:
    - cron: "15 16 * 1,2,11,12 *"   # Winter
    - cron: "15 15 * 3-10 *"        # Summer
  workflow_dispatch:              # Manual trigger

env:
  IMAGE: ghcr.io/epereztg/aimharder-bot:latest

jobs:
  book:
    runs-on: ubuntu-latest
    permissions:
      packages: read

    steps:
      - name: Log in to GitHub Container Registry
        uses: docker/login-action@v3
        with:
          registry: ghcr.io
          username: ${{ github.actor }}
          password: ${{ secrets.GITHUB_TOKEN }}

      - name: Run booking script
        env:
          EMAIL: ${{ secrets.EMAIL }}
          PASSWORD: ${{ secrets.PASSWORD }}
          TARGET_HOUR: 18
          TARGET_MINUTE: 30
          TELEGRAM_TOKEN: ${{ secrets.TELEGRAM_TOKEN }}
          TELEGRAM_CHAT_ID: ${{ secrets.TELEGRAM_CHAT_ID }}
        run: |
          echo "ðŸš€ Processing Box 10002..."
          docker run --rm \
            -e EMAIL -e PASSWORD \
            -e TARGET_HOUR -e TARGET_MINUTE \
            -e TELEGRAM_TOKEN -e TELEGRAM_CHAT_ID \
            ${{ env.IMAGE }} \
            python main.py --days-ahead 2 --schedule schedule_10002.json
